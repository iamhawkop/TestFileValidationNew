import java.awt.Robot;
import java.awt.event.KeyEvent;
import java.awt.Toolkit;
import java.awt.datatransfer.StringSelection;

public class SaveAsDefaultFilename {

    public static void saveToTargetFolder() throws Exception {
        // Only the folder path, no filename
        String folderPath = System.getProperty("user.dir") + "\\target\\downloads\\";

        // Copy folder path to clipboard
        StringSelection selection = new StringSelection(folderPath);
        Toolkit.getDefaultToolkit().getSystemClipboard().setContents(selection, null);

        Robot robot = new Robot();
        Thread.sleep(2000); // Wait for Save As dialog to appear

        // Paste the folder path
        robot.keyPress(KeyEvent.VK_CONTROL);
        robot.keyPress(KeyEvent.VK_V);
        robot.keyRelease(KeyEvent.VK_V);
        robot.keyRelease(KeyEvent.VK_CONTROL);

        Thread.sleep(500); // Small pause

        // Press Enter to accept default filename
        robot.keyPress(KeyEvent.VK_ENTER);
        robot.keyRelease(KeyEvent.VK_ENTER);

        System.out.println("File will be saved to folder: " + folderPath + " with its default name");
    }

    public static void main(String[] args) throws Exception {
        saveToTargetFolder();
    }
}
